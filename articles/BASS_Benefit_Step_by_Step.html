<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Step by Step • BASSr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Step by Step">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BASSr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/BASSr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/BASS_Benefit_Step_by_Step.html">Step by Step</a></li>
    <li><a class="dropdown-item" href="../articles/BASSr_real.html">Getting Started - Some real data</a></li>
    <li><a class="dropdown-item" href="../articles/CostBreakDown.html">Cost Breakdown</a></li>
    <li><a class="dropdown-item" href="../articles/Workflow.html">BASSr Workflow</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dhope/BASSr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Step by Step</h1>
                        <h4 data-toc-skip class="author">David Hope</h4>
            
            <h4 data-toc-skip class="date">2025-06-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/dhope/BASSr/blob/main/vignettes/BASS_Benefit_Step_by_Step.Rmd" class="external-link"><code>vignettes/BASS_Benefit_Step_by_Step.Rmd</code></a></small>
      <div class="d-none name"><code>BASS_Benefit_Step_by_Step.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span></span>
<span>  eval <span class="op">=</span> <span class="cn">T</span>, warning <span class="op">=</span> <span class="cn">F</span>, message <span class="op">=</span> <span class="cn">F</span>,<span class="co">#cache = T,echo=F,</span></span>
<span>  collapse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  comment <span class="op">=</span> <span class="st">"#&gt;"</span></span>
<span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dhope/BASSr" class="external-link">BASSr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glue.tidyverse.org/" class="external-link">glue</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">ont.proj</span> <span class="op">&lt;-</span> <span class="fl">3161</span></span></code></pre></div>
<div class="section level2">
<h2 id="benefit-definition">Benefit definition<a class="anchor" aria-label="anchor" href="#benefit-definition"></a>
</h2>
<p>The process of calculating benefit can be defined below:</p>
<p>1 .Calculate percentage of land cover type in:<br>
a. Study area
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mrow><mi>S</mi><mi>A</mi></mrow></msub><annotation encoding="application/x-tex">p_{SA}</annotation></semantics></math>)
b. Hypothetical sample set
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mrow><mi>H</mi><mi>S</mi><mi>S</mi></mrow></msub><annotation encoding="application/x-tex">p_{HSS}</annotation></semantics></math>)
c. Hypothetical sample set plus focal sample unit
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>p</mi><mrow><mi>H</mi><mi>S</mi><mi>S</mi></mrow><mo>*</mo></msubsup><annotation encoding="application/x-tex">p_{HSS}^*</annotation></semantics></math>)
2.Calculate difference between Study area and sample sets: a.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>Δ</mi><mi>H</mi><mi>S</mi><mi>S</mi></mrow><mo>=</mo><msub><mi>p</mi><mrow><mi>S</mi><mi>A</mi></mrow></msub><mo>−</mo><msub><mi>p</mi><mrow><mi>H</mi><mi>S</mi><mi>S</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\Delta HSS} = {p_{SA}} - {p_{HSS}}</annotation></semantics></math></p>
<ol start="2" style="list-style-type: lower-alpha">
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>Δ</mi><mi>H</mi><mi>S</mi><msup><mi>S</mi><mo>*</mo></msup></mrow><mo>=</mo><msub><mi>p</mi><mrow><mi>S</mi><mi>A</mi></mrow></msub><mo>−</mo><msubsup><mi>p</mi><mrow><mi>H</mi><mi>S</mi><mi>S</mi></mrow><mo>*</mo></msubsup></mrow><annotation encoding="application/x-tex">{\Delta HSS^*} = {p_{SA}} - {p_{HSS}^*}</annotation></semantics></math></li>
</ol>
<p>Calculate benefit for land cover type
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
in sample unit
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
with a given hypothetical sample set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
as:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mrow><mi>H</mi><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>p</mi><mrow><mi>H</mi><mi>S</mi><mi>S</mi></mrow></msub><mo>−</mo><msubsup><mi>p</mi><mrow><mi>H</mi><mi>S</mi><mi>S</mi></mrow><mo>*</mo></msubsup><mo stretchy="true" form="postfix">|</mo></mrow><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>s</mi><mi>g</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Δ</mi><mi>H</mi><mi>S</mi><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>s</mi><mi>g</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Δ</mi><mi>H</mi><mi>S</mi><msup><mi>S</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>s</mi><mi>g</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Δ</mi><mi>H</mi><mi>S</mi><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>≠</mo><mi>s</mi><mi>g</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Δ</mi><mi>H</mi><mi>S</mi><msup><mi>S</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
    \beta_{Hij} =   \begin{cases}
    | p_{HSS} - p_{HSS}^*| ,&amp; \text{if } sgn(\Delta HSS) = sgn(\Delta HSS^*) \\
    0,&amp; \text{if } sgn(\Delta HSS) \neq sgn(\Delta HSS^*)
  \end{cases}
  </annotation></semantics></math></p>
<p>If we consider the proportion of a land cover type as the value of
interest: <strong>If</strong>: the difference between the
<code>value</code> for the study area and the <code>value</code> for the
hypothetical sample set <strong>and</strong> the difference between the
<code>value</code> for the study area and the <code>value</code> for the
hypothetical sample set <em>plus</em> the focal sample unit <strong>are
either both positive or both negative</strong> <strong>then</strong>:
The benefit for a land cover type is: the difference between the
<code>value</code> for the hypothetical sample set and
<code>value</code> for the hypothetical sample set plus the focal sample
unit. <strong>otherwise</strong>: the benefit is 0.</p>
</div>
<div class="section level2">
<h2 id="example-work-through">Example work through<a class="anchor" aria-label="anchor" href="#example-work-through"></a>
</h2>
<p>This is an example of how we calculate the benefit for one sample
unit in a study area. The same approach applies to all other sample unit
hexagons in the study area and also to calculating benefits for the
study area hexagons in a region.</p>
</div>
<div class="section level2">
<h2 id="step-1---load-in-data">Step 1 - Load in data<a class="anchor" aria-label="anchor" href="#step-1---load-in-data"></a>
</h2>
<p>Here you will need a simple features (package sf) layer of hexagons
for the study areas and sample units. Code to create the hexagons is
available in <code>Hexagon Creation</code> vignette. The first step is
to create or load both the study area and sample units.</p>
<p>The data for the vignette is included in the package. It should load
with the <code>BASSr</code> package. You’ll need the objects
<code>ontario</code>, <code>clrfile</code>, <code>lcc2015_codes</code>,
<code>all_study_areas</code>, and <code>StudyArea_hexes</code>.
Documentation for these objects is found by using the help function (eg
<code><a href="../reference/ontario.html">?BASSr::ontario</a></code>). The raster for the example study area can
be found in the system data (see chunk <code>raster-plot</code>
below).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study_area_id</span> <span class="op">&lt;-</span> <span class="st">"ONT_SA_0740"</span></span>
<span></span>
<span><span class="va">SA_sum</span> <span class="op">&lt;-</span> <span class="va">StudyArea_hexes</span><span class="op">$</span><span class="va">landcover</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html" class="external-link">summarize_at</a></span><span class="op">(</span>.vars <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"LC"</span><span class="op">)</span><span class="op">)</span>, .funs <span class="op">=</span> <span class="va">sum</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"LC"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"lc"</span>, values_to <span class="op">=</span> <span class="st">"pHab_SA"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pHab_SA <span class="op">=</span> <span class="va">pHab_SA</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pHab_SA</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">pHab_SA</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    cHAb_SA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">pHab_SA</span><span class="op">)</span>,</span>
<span>    lcFac <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html" class="external-link">fct_reorder</a></span><span class="op">(</span><span class="va">lc</span>, <span class="va">pHab_SA</span><span class="op">)</span>,</span>
<span>    lc_n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html" class="external-link">str_extract</a></span><span class="op">(</span><span class="va">lc</span>, <span class="st">"\\d\\d"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">lcc2015_codes</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lc_n"</span> <span class="op">=</span> <span class="st">"LCC_CODE"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>lcc_fac <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html" class="external-link">fct_reorder</a></span><span class="op">(</span><span class="va">LCC_NAME</span>, <span class="va">pHab_SA</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2277</span><span class="op">)</span></span>
<span><span class="va">exampleHex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_sample</a></span><span class="op">(</span><span class="va">StudyArea_hexes</span><span class="op">$</span><span class="va">landcover</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hex_LC</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">StudyArea_hexes</span><span class="op">$</span><span class="va">landcover</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">geometry</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"LC"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"lc"</span>, values_to <span class="op">=</span> <span class="st">"pHab"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">SA_sum</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lc"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">SampleUnitID</span>, <span class="va">pHab_SA</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">SampleUnitID</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cpHab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">pHab</span> <span class="op">/</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>lc_n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html" class="external-link">str_extract</a></span><span class="op">(</span><span class="va">lc</span>, <span class="st">"\\d\\d"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">exLC</span> <span class="op">&lt;-</span> <span class="va">hex_LC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SampleUnitID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">exampleHex</span><span class="op">$</span><span class="va">SampleUnitID</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">all_study_areas</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ontario</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">all_study_areas</span>, <span class="va">StudyAreaID</span> <span class="op">==</span> <span class="va">study_area_id</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="BASS_Benefit_Step_by_Step_files/figure-html/ontario-map-1.png" alt="Figure 1. Map of Ontario study areas with example study area shown in red" width="768"><p class="caption">
Figure 1. Map of Ontario study areas with example study area shown in
red
</p>
</div>
<p>The sample unit will focus on a single sample unit within the study
area, shown below in red. We will call this the ‘focal sample unit’.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">exampleHex</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">StudyArea_hexes</span><span class="op">$</span><span class="va">landcover</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="BASS_Benefit_Step_by_Step_files/figure-html/unnamed-chunk-1-1.png" alt="Figure 2. Example sample unit hexagon (in red). Used as the focal sample unit for the next steps." width="700"><p class="caption">
Figure 2. Example sample unit hexagon (in red). Used as the focal sample
unit for the next steps.
</p>
</div>
</div>
<div class="section level2">
<h2 id="step-2-calculate-habitat-composition">Step 2 Calculate Habitat Composition<a class="anchor" aria-label="anchor" href="#step-2-calculate-habitat-composition"></a>
</h2>
<p>This example study area is shown below. The habitat is shown from the
National Land Cover Classification 2015. The study area is 1003 sample
unit hexagons of
1e+06<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>m</mi><mn>2</mn></msup><annotation encoding="application/x-tex">m^2</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"{study_area_id}.tif"</span><span class="op">)</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"BASSr"</span>, mustWork <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span>xy <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="op">{</span><span class="op">{</span><span class="va">study_area_id</span><span class="op">}</span><span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">lcc2015_codes</span>, by <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">join_by</a></span><span class="op">(</span><span class="op">{</span><span class="op">{</span><span class="va">study_area_id</span><span class="op">}</span><span class="op">}</span> <span class="op">==</span> <span class="va">LCC_CODE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">pal_</span> <span class="op">&lt;-</span> <span class="va">clrfile</span><span class="op">$</span><span class="va">rgb</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pal_</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">clrfile</span><span class="op">$</span><span class="va">LCC_NAME</span><span class="op">)</span></span>
<span><span class="va">pal_</span> <span class="op">&lt;-</span> <span class="va">pal_</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pal_</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span></span>
<span><span class="va">lc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">r</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, fill <span class="op">=</span> <span class="va">LCC_NAME</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_discrete_manual</a></span><span class="op">(</span>aesthetics <span class="op">=</span> <span class="st">"fill"</span>, values <span class="op">=</span> <span class="va">pal_</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">StudyArea_hexes</span><span class="op">$</span><span class="va">landcover</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span>, fill <span class="op">=</span> <span class="st">"LCC2015"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">lc</span></span></code></pre></div>
<div class="figure">
<img src="BASS_Benefit_Step_by_Step_files/figure-html/raster-plot-1.png" alt="Figure 3. The distribution of land cover classes across an example study area." width="700"><p class="caption">
Figure 3. The distribution of land cover classes across an example study
area.
</p>
</div>
<p>Overall, the study area is primarily classified as “Sub-polar or
polar grassland-lichen-moss” or “Wetland”, however there are
<code>n_distinct(exLC$lc)</code> classes in the study area.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exLC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">lcc_fac</span>, <span class="va">pHab_SA</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pHab_SA <span class="op">=</span> <span class="va">pHab_SA</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"sampletype_s"</span>, values_to <span class="op">=</span> <span class="st">"phabitat"</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pHab_SA"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sampletype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">sampletype_s</span> <span class="op">==</span> <span class="st">"pHab"</span>, <span class="st">"Example Sample Unit"</span>, <span class="st">"Study Area"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">sampletype</span>, <span class="va">phabitat</span>, fill <span class="op">=</span> <span class="va">lcc_fac</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"Percentage of total"</span>, fill <span class="op">=</span> <span class="st">"Land Cover"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">pal_</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="BASS_Benefit_Step_by_Step_files/figure-html/study-area-landcover-plot-1.png" alt="Figure 4. The distribution of National Land Cover Classes within example Study Area" width="700"><p class="caption">
Figure 4. The distribution of National Land Cover Classes within example
Study Area
</p>
</div>
<p>There is variation in the composition of land cover classes among
sample units. If we examine the increasing cumulative proportion of a
sample unit hexagon covered by a given land cover type, we see a lot of
variation in this distribution between the 1003 hexagons. The focal
sample unit is shown in red below.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">hex_LC</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">lcc_fac</span>, <span class="va">cpHab</span>, group <span class="op">=</span> <span class="va">SampleUnitID</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_step</a></span><span class="op">(</span></span>
<span>    colour <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_step</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">exLC</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"red"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_step</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">SA_sum</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">cHAb_SA</span>, group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Land Cover Class (Increasing freq from left to right)"</span>, y <span class="op">=</span> <span class="st">"Cumulative proportion of hexagon"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span></span>
<span>    family <span class="op">=</span> <span class="st">"mono"</span>,</span>
<span>    angle <span class="op">=</span> <span class="fl">75</span>, vjust <span class="op">=</span> <span class="fl">1</span>, hjust <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="BASS_Benefit_Step_by_Step_files/figure-html/land-cover-hexes-1.png" alt="Figure 5. The cumulative proportion of land cover classes within sample hexagons (grey) and the study area (black). The red line shows the example hexagon used in the initial benefit calculation." width="768"><p class="caption">
Figure 5. The cumulative proportion of land cover classes within sample
hexagons (grey) and the study area (black). The red line shows the
example hexagon used in the initial benefit calculation.
</p>
</div>
<hr>
</div>
<div class="section level2">
<h2 id="step-3-sample-unit-hexagons---benefit-calculation">Step 3 Sample unit hexagons - benefit calculation<a class="anchor" aria-label="anchor" href="#step-3-sample-unit-hexagons---benefit-calculation"></a>
</h2>
<div class="section level3">
<h3 id="a----select-a-sample-unit-to-calculate-benefit-for">A. - Select a sample unit to calculate benefit for<a class="anchor" aria-label="anchor" href="#a----select-a-sample-unit-to-calculate-benefit-for"></a>
</h3>
<p>Lets focus on one sample unit hexagon for now. It is shown in Figure
2 and 5 and with the land cover below (Figure 6). As mentioned above, we
will call it the <em>focal sample unit</em> for now.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="va">r</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&lt;</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="va">exampleHex</span><span class="op">)</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&gt;</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="va">exampleHex</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">y</span> <span class="op">&lt;</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="va">exampleHex</span><span class="op">)</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">y</span> <span class="op">&gt;</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="va">exampleHex</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">r2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, fill <span class="op">=</span> <span class="va">LCC_NAME</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_discrete_manual</a></span><span class="op">(</span>aesthetics <span class="op">=</span> <span class="st">"fill"</span>, values <span class="op">=</span> <span class="va">pal_</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span>, fill <span class="op">=</span> <span class="st">"LCC2015"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># ggspatial::annotation_scale(location = "bl", width_hint = 0.4)  +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">exampleHex</span>, fill <span class="op">=</span> <span class="cn">NA</span>, colour <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="va">exampleHex</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="va">exampleHex</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="BASS_Benefit_Step_by_Step_files/figure-html/unnamed-chunk-2-1.png" alt="Figure 6. Example sample unit hexagon (in outline). Used as the focal sample unit for the next steps. See Figure 3 for legend." width="700"><p class="caption">
Figure 6. Example sample unit hexagon (in outline). Used as the focal
sample unit for the next steps. See Figure 3 for legend.
</p>
</div>
<p>The focal sample unit varies in many ways from the study area. If we
compare the ‘focal sample unit’ proportion of “Sub-polar or polar
grassland-lichen-moss” to that found throughout the study area we can
see the focal sample unit has a much lower percentage than the study
area.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exLC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">lcc_fac</span>, <span class="va">pHab</span>, <span class="va">pHab_SA</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pHab_SA <span class="op">=</span> <span class="va">pHab_SA</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"sampletype_s"</span>, values_to <span class="op">=</span> <span class="st">"phabitat"</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pHab_SA"</span>, <span class="st">"pHab"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sampletype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">sampletype_s</span> <span class="op">==</span> <span class="st">"pHab"</span>, <span class="st">"Focal Sample Unit"</span>, <span class="st">"Study Area"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"grassland-lichen-moss"</span>, <span class="va">lcc_fac</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">sampletype</span>, <span class="va">phabitat</span>, fill <span class="op">=</span> <span class="va">lcc_fac</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"Percentage of total"</span>, fill <span class="op">=</span> <span class="st">"Land Cover"</span>, title <span class="op">=</span> <span class="va">exLC</span><span class="op">$</span><span class="va">LCC_NAME</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"grassland-lichen-moss"</span>, <span class="va">exLC</span><span class="op">$</span><span class="va">LCC_NAME</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">pal_</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">lims</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="BASS_Benefit_Step_by_Step_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exLC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">lcc_fac</span>, <span class="va">pHab</span>, <span class="va">pHab_SA</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pHab_SA <span class="op">=</span> <span class="va">pHab_SA</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"sampletype_s"</span>, values_to <span class="op">=</span> <span class="st">"phabitat"</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pHab_SA"</span>, <span class="st">"pHab"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sampletype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">sampletype_s</span> <span class="op">==</span> <span class="st">"pHab"</span>, <span class="st">"Focal Sample Unit"</span>, <span class="st">"Study Area"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"grassland-lichen-moss|Wetland"</span>, <span class="va">lcc_fac</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">sampletype</span>, <span class="va">phabitat</span>, fill <span class="op">=</span> <span class="va">lcc_fac</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"Percentage of total"</span>, fill <span class="op">=</span> <span class="st">"Land Cover"</span>,</span>
<span>    title <span class="op">=</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"{exLC$LCC_NAME[grepl('grassland-lichen-moss',exLC$LCC_NAME)]} and Wetland"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">pal_</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">lims</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="BASS_Benefit_Step_by_Step_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exLC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">lcc_fac</span>, <span class="va">pHab</span>, <span class="va">pHab_SA</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pHab_SA <span class="op">=</span> <span class="va">pHab_SA</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"sampletype_s"</span>, values_to <span class="op">=</span> <span class="st">"phabitat"</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pHab_SA"</span>, <span class="st">"pHab"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sampletype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">sampletype_s</span> <span class="op">==</span> <span class="st">"pHab"</span>, <span class="st">"Focal Sample Unit"</span>, <span class="st">"Study Area"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">sampletype</span>, <span class="va">phabitat</span>, fill <span class="op">=</span> <span class="va">lcc_fac</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"Percentage of total"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Land Cover"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">pal_</span><span class="op">)</span></span></code></pre></div>
<p><img src="BASS_Benefit_Step_by_Step_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>The table below compares how the percentages of land cover types
differs between the example sample unit and the study area. In this
example, the focal sample unit has a large proportion of “Temperate or
sub-polar shrubland” relative to the study area, but the percentage of
“Sub-polar or polar grassland-lichen-moss” is much lower than the study
area. These differences with the study area will form the backbone of
the benefit calculation for this focal sample unit.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exLC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">lcc_fac</span>, <span class="va">pHab</span>, <span class="va">pHab_SA</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pHab_SA <span class="op">=</span> <span class="va">pHab_SA</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Land Cover"</span>, <span class="st">"% Example Sample Unit"</span>, <span class="st">"% Example Study Area"</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="53%">
<col width="23%">
<col width="22%">
</colgroup>
<thead><tr class="header">
<th align="left">Land Cover</th>
<th align="right">% Example Sample Unit</th>
<th align="right">% Example Study Area</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Sub-polar or polar shrubland-lichen-moss</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">Urban and Built-up</td>
<td align="right">0.00</td>
<td align="right">0.04</td>
</tr>
<tr class="odd">
<td align="left">Mixed Forest</td>
<td align="right">0.00</td>
<td align="right">0.14</td>
</tr>
<tr class="even">
<td align="left">Temperate or sub-polar broadleaf deciduous forest</td>
<td align="right">0.09</td>
<td align="right">0.85</td>
</tr>
<tr class="odd">
<td align="left">Temperate or sub-polar needleleaf forest</td>
<td align="right">0.74</td>
<td align="right">1.46</td>
</tr>
<tr class="even">
<td align="left">Barren Lands</td>
<td align="right">0.00</td>
<td align="right">3.29</td>
</tr>
<tr class="odd">
<td align="left">Water</td>
<td align="right">15.00</td>
<td align="right">6.85</td>
</tr>
<tr class="even">
<td align="left">Temperate or sub-polar shrubland</td>
<td align="right">37.31</td>
<td align="right">7.08</td>
</tr>
<tr class="odd">
<td align="left">Temperate or sub-polar grassland</td>
<td align="right">0.00</td>
<td align="right">8.58</td>
</tr>
<tr class="even">
<td align="left">Sub-polar or polar barren-lichen-moss</td>
<td align="right">2.87</td>
<td align="right">9.79</td>
</tr>
<tr class="odd">
<td align="left">Sub-polar taiga needleleaf forest</td>
<td align="right">8.15</td>
<td align="right">10.78</td>
</tr>
<tr class="even">
<td align="left">Wetland</td>
<td align="right">30.19</td>
<td align="right">20.36</td>
</tr>
<tr class="odd">
<td align="left">Sub-polar or polar grassland-lichen-moss</td>
<td align="right">5.65</td>
<td align="right">30.78</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="b----draw-a-hypothetical-sample-set-from-all-sample-units-in-study-area">B. - Draw a hypothetical sample set from all sample units in study
area<a class="anchor" aria-label="anchor" href="#b----draw-a-hypothetical-sample-set-from-all-sample-units-in-study-area"></a>
</h3>
<p>To examine the importance of the focal sample unit, we first draw 1
random, spatially-dispersed sample set comprised of 10 sample unit
hexagons. These 10 randomly drawn sample units are defined as the
<em>hypothetical sample set</em>. They are used to estimate how the
focal sample unit will increase (or decrease) the representivity of the
sample set.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_hexes</span> <span class="op">&lt;-</span> <span class="fu">BASSr</span><span class="fu">::</span><span class="fu"><a href="../reference/draw_random_samples.html">draw_random_samples</a></span><span class="op">(</span></span>
<span>  land_hex <span class="op">=</span> <span class="va">StudyArea_hexes</span><span class="op">$</span><span class="va">landcover</span>,</span>
<span>  num_runs <span class="op">=</span> <span class="fl">1</span>, n_samples <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sample_hexes_sf</span> <span class="op">&lt;-</span> <span class="va">StudyArea_hexes</span><span class="op">$</span><span class="va">landcover</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SampleUnitID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_hexes</span><span class="op">$</span><span class="va">SampleUnitID</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hex_wHHS</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">exampleHex</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">StudyArea_hexes</span><span class="op">$</span><span class="va">landcover</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sample_hexes_sf</span>, fill <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hex_wHHS</span></span></code></pre></div>
<div class="figure">
<img src="BASS_Benefit_Step_by_Step_files/figure-html/unnamed-chunk-6-1.png" alt="Figure 5. Plot of focal sample unit (red) and the hypothetical sample set (grey) within the study area (all hexagons)." width="700"><p class="caption">
Figure 5. Plot of focal sample unit (red) and the hypothetical sample
set (grey) within the study area (all hexagons).
</p>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_hexes_phab</span> <span class="op">&lt;-</span> <span class="va">hex_LC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SampleUnitID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_hexes_sf</span><span class="op">$</span><span class="va">SampleUnitID</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">lcc_fac</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>pHab_samp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pHab</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pHab_samp <span class="op">=</span> <span class="va">pHab_samp</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pHab_samp</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m2toha</span> <span class="op">&lt;-</span> <span class="fl">0.0001</span></span>
<span><span class="va">study_area_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html" class="external-link">st_area</a></span><span class="op">(</span><span class="va">StudyArea_hexes</span><span class="op">$</span><span class="va">landcover</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">m2toha</span></span>
<span><span class="va">hexsize</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html" class="external-link">st_area</a></span><span class="op">(</span><span class="va">exampleHex</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">m2toha</span></span>
<span></span>
<span></span>
<span><span class="va">samp_com</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">exLC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">lcc_fac</span>, <span class="va">pHab</span>, <span class="va">pHab_SA</span><span class="op">)</span>, <span class="va">sample_hexes_phab</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    pHab_Sample_plus_hex <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="va">pHab</span> <span class="op">*</span> <span class="va">hexsize</span> <span class="op">+</span> <span class="va">pHab_samp</span> <span class="op">*</span> <span class="va">hexsize</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span> <span class="op">/</span></span>
<span>      <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pHab</span> <span class="op">*</span> <span class="va">hexsize</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pHab_samp</span> <span class="op">*</span> <span class="va">hexsize</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    pHab_SA <span class="op">=</span> <span class="va">pHab_SA</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">lcc_fac</span>, <span class="va">pHab</span>, <span class="va">pHab_samp</span>, <span class="va">pHab_Sample_plus_hex</span>, <span class="va">pHab_SA</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">samp_com</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lcFac"</span>, <span class="st">"Focal Sample Unit"</span>, <span class="st">"Hypothetical Sample Set"</span>, <span class="st">"Sample Set + Sample Unit"</span>, <span class="st">"Study Area"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">samp_com</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"sampletype"</span>, values_to <span class="op">=</span> <span class="st">"phabitat"</span>, cols <span class="op">=</span> <span class="op">-</span><span class="va">lcFac</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sampletype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">sampletype</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Focal Sample Unit"</span>, <span class="st">"Hypothetical Sample Set"</span>, <span class="st">"Sample Set + Sample Unit"</span>, <span class="st">"Study Area"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># c("Hexagon",  "Sample", "Sample + Hex","Study Area")))</span></span>
<span><span class="va">plot_single</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">lcFac</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pal_</span><span class="op">[</span><span class="va">x</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">sampletype</span>, <span class="va">phabitat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="va">pal_</span><span class="op">[</span><span class="va">x</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># scale_fill_viridis_d() +</span></span>
<span>    <span class="co"># scale_fill_manual(values = pal_)+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"Percentage of total"</span>, fill <span class="op">=</span> <span class="st">"Land Cover"</span>, title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pal_</span><span class="op">[</span><span class="va">x</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"{round(phabitat,1)} %"</span><span class="op">)</span><span class="op">)</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html" class="external-link">position_nudge</a></span><span class="op">(</span>y <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hexplot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fill_</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">exampleHex</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">fill_</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>      panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">hhs_plot</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">StudyArea_hexes</span><span class="op">$</span><span class="va">landcover</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">NA</span>, colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, axis.line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">key_row</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">hhs_plot</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">exampleHex</span>, fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">hhs_plot</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sample_hexes_sf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">(</span><span class="va">hhs_plot</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">exampleHex</span>, fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sample_hexes_sf</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">hhs_plot</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># (hex_wHHS + theme(axis.text = element_blank())) /</span></span>
<span></span>
<span><span class="op">(</span><span class="fu">plot_single</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">key_row</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="BASS_Benefit_Step_by_Step_files/figure-html/unnamed-chunk-8-1.png" width="700">
Hypothetical Sample Set 9.9% less Wetland than Study Area Only 8.1% less
than Study Area with inclusion of Focal Sample Unit Therefore Focal
Sample Unit makes Sample Set more like Study Area Therefore Benefit!
Benefit = 0.18 or 1.8%</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="fu">plot_single</span><span class="op">(</span><span class="fl">14</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">key_row</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="BASS_Benefit_Step_by_Step_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>Hypothetical Sample Set 2.6% greater shrubland than Study Area 5.1%
greater than Study Area with inclusion of Focal Sample Unit Therefore
Focal Sample Unit makes Sample Set less like Study Area Therefore NO
Benefit Benefit = 0</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fullplot</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">sampletype</span>, <span class="va">phabitat</span>, fill <span class="op">=</span> <span class="va">lcFac</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">pal_</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"Percentage of total"</span>, fill <span class="op">=</span> <span class="st">"Land Cover"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="op">(</span><span class="va">fullplot</span> <span class="op">/</span> <span class="op">(</span><span class="va">key_row</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="BASS_Benefit_Step_by_Step_files/figure-html/unnamed-chunk-10-1.png" alt="Figure 6. Distribution of land cover by focal sample unit, hypothetical sample set, hypothetical sample set plus focal sample unit and study area" width="1344"><p class="caption">
Figure 6. Distribution of land cover by focal sample unit, hypothetical
sample set, hypothetical sample set plus focal sample unit and study
area
</p>
</div>
<p>The next step is to compare how the habitat representivity differs
between the focal sample unit, the hypothetical sample set, the
hypothetical sample set with the focal sample unit included and the
study area as a whole. Here we can see that the hypothetical sample set
has a larger percentage of “Sub-polar taiga needleleaf forest” than the
study area, while the focal sample unit has a lower percentage than the
study area. When the focal sample unit is added to the sample set, the
percentage shifts downwards and closer to the percentage for the study
area. The opposite is true for “Temperate or sub-polar shrubland”, where
adding the focal sample unit moves the sample set plus focal sample unit
away from the percentage observed at the study area. This is the
fundamental measure of representivity for the focal sample unit.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">samp_com</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="39%">
<col width="14%">
<col width="18%">
<col width="19%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left">lcFac</th>
<th align="right">Focal Sample Unit</th>
<th align="right">Hypothetical Sample Set</th>
<th align="right">Sample Set + Sample Unit</th>
<th align="right">Study Area</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Sub-polar or polar shrubland-lichen-moss</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">Urban and Built-up</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.04</td>
</tr>
<tr class="odd">
<td align="left">Mixed Forest</td>
<td align="right">0.00</td>
<td align="right">0.06</td>
<td align="right">0.05</td>
<td align="right">0.14</td>
</tr>
<tr class="even">
<td align="left">Temperate or sub-polar broadleaf deciduous forest</td>
<td align="right">0.09</td>
<td align="right">0.48</td>
<td align="right">0.45</td>
<td align="right">0.85</td>
</tr>
<tr class="odd">
<td align="left">Temperate or sub-polar needleleaf forest</td>
<td align="right">0.74</td>
<td align="right">2.49</td>
<td align="right">2.33</td>
<td align="right">1.46</td>
</tr>
<tr class="even">
<td align="left">Barren Lands</td>
<td align="right">0.00</td>
<td align="right">2.19</td>
<td align="right">1.99</td>
<td align="right">3.29</td>
</tr>
<tr class="odd">
<td align="left">Water</td>
<td align="right">15.00</td>
<td align="right">7.26</td>
<td align="right">7.96</td>
<td align="right">6.85</td>
</tr>
<tr class="even">
<td align="left">Temperate or sub-polar shrubland</td>
<td align="right">37.31</td>
<td align="right">5.92</td>
<td align="right">8.78</td>
<td align="right">7.08</td>
</tr>
<tr class="odd">
<td align="left">Temperate or sub-polar grassland</td>
<td align="right">0.00</td>
<td align="right">8.48</td>
<td align="right">7.71</td>
<td align="right">8.58</td>
</tr>
<tr class="even">
<td align="left">Sub-polar or polar barren-lichen-moss</td>
<td align="right">2.87</td>
<td align="right">11.19</td>
<td align="right">10.43</td>
<td align="right">9.79</td>
</tr>
<tr class="odd">
<td align="left">Sub-polar taiga needleleaf forest</td>
<td align="right">8.15</td>
<td align="right">7.14</td>
<td align="right">7.23</td>
<td align="right">10.78</td>
</tr>
<tr class="even">
<td align="left">Wetland</td>
<td align="right">30.19</td>
<td align="right">25.81</td>
<td align="right">26.21</td>
<td align="right">20.36</td>
</tr>
<tr class="odd">
<td align="left">Sub-polar or polar grassland-lichen-moss</td>
<td align="right">5.65</td>
<td align="right">28.99</td>
<td align="right">26.87</td>
<td align="right">30.78</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="c----calculate-representivity">C. - Calculate representivity<a class="anchor" aria-label="anchor" href="#c----calculate-representivity"></a>
</h3>
<p>As mentioned above, adding the focal sample unit to the sample set,
shifts the habitat composition slightly and more so when the focal
sample unit is quite different from the sample set. We now want to see
if adding the sample unit to the hypothetical sample set will make the
<em>updated</em> sample set more representative of the study area.</p>
<hr>
</div>
<div class="section level3">
<h3 id="d----calculate-benefit-for-sample-unit">D. - Calculate benefit for sample unit<a class="anchor" aria-label="anchor" href="#d----calculate-benefit-for-sample-unit"></a>
</h3>
<p>To calculate the benefit for the focal sample unit, we determine for
each land cover class if including the focal sample unit to the
hypothetical sample set makes the sample set more or less
representative. If, for a given land cover class, the hypothetical
sample set becomes more similar to the study area, the benefit is the
difference between the hypothetical sample set’s representivity (here
percentage of a land cover class) and the representivity if the sample
unit is added into the sample set. Otherwise, the benefit for that land
cover class is zero.</p>
<p>The benefit across all land cover types is summed to make the benefit
value for that focal sample unit with that hypothetical sample set.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mrow><mi>H</mi><mi>j</mi></mrow></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>=</mo><mi>k</mi></mrow></munderover><msub><mi>β</mi><mrow><mi>H</mi><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\beta_{Hj} = \sum_{i = 1}^{i = k}\beta_{Hij} </annotation></semantics></math></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rep_tabl</span> <span class="op">&lt;-</span> <span class="va">samp_com</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># mutate_at(vars(-lcFac), ~(.*study_area_size))</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    `Desired Direction` <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">`Study Area`</span> <span class="op">&gt;</span> <span class="va">`Hypothetical Sample Set`</span> <span class="op">~</span> <span class="st">"Positive"</span>,</span>
<span>      <span class="va">`Study Area`</span> <span class="op">&lt;</span> <span class="va">`Hypothetical Sample Set`</span> <span class="op">~</span> <span class="st">"Negative"</span>,</span>
<span>      <span class="va">`Study Area`</span> <span class="op">==</span> <span class="va">`Hypothetical Sample Set`</span> <span class="op">~</span> <span class="st">"None"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    `Observed Direction` <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">`Sample Set + Sample Unit`</span> <span class="op">&gt;</span> <span class="va">`Hypothetical Sample Set`</span> <span class="op">~</span> <span class="st">"Positive"</span>,</span>
<span>      <span class="va">`Sample Set + Sample Unit`</span> <span class="op">&lt;</span> <span class="va">`Hypothetical Sample Set`</span> <span class="op">~</span> <span class="st">"Negative"</span>,</span>
<span>      <span class="va">`Sample Set + Sample Unit`</span> <span class="op">==</span> <span class="va">`Hypothetical Sample Set`</span> <span class="op">~</span> <span class="st">"None"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    `Land Cover Benefit` <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">`Observed Direction`</span> <span class="op">==</span> <span class="st">"None"</span> <span class="op">~</span> <span class="st">"No Benefit"</span>,</span>
<span>      <span class="va">`Desired Direction`</span> <span class="op">==</span> <span class="va">`Observed Direction`</span> <span class="op">~</span> <span class="st">"Benefit"</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"No Benefit"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    benefit <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">`Land Cover Benefit`</span> <span class="op">==</span> <span class="st">"Benefit"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">`Hypothetical Sample Set`</span> <span class="op">-</span> <span class="va">`Sample Set + Sample Unit`</span><span class="op">)</span> <span class="op">/</span> <span class="fl">100</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Benefit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">benefit</span> <span class="op">==</span> <span class="fl">0</span>, <span class="st">"0"</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">benefit</span> <span class="op">&lt;</span> <span class="fl">0.001</span>, <span class="st">"&lt;0.001"</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">benefit</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">rep_tabl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">benefit</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="26%">
<col width="9%">
<col width="12%">
<col width="13%">
<col width="5%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="4%">
</colgroup>
<thead><tr class="header">
<th align="left">lcFac</th>
<th align="right">Focal Sample Unit</th>
<th align="right">Hypothetical Sample Set</th>
<th align="right">Sample Set + Sample Unit</th>
<th align="right">Study Area</th>
<th align="left">Desired Direction</th>
<th align="left">Observed Direction</th>
<th align="left">Land Cover Benefit</th>
<th align="left">Benefit</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Sub-polar or polar shrubland-lichen-moss</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="left">Positive</td>
<td align="left">None</td>
<td align="left">No Benefit</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">Urban and Built-up</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.04</td>
<td align="left">Positive</td>
<td align="left">None</td>
<td align="left">No Benefit</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">Mixed Forest</td>
<td align="right">0.00</td>
<td align="right">0.06</td>
<td align="right">0.05</td>
<td align="right">0.14</td>
<td align="left">Positive</td>
<td align="left">Negative</td>
<td align="left">No Benefit</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">Temperate or sub-polar broadleaf deciduous forest</td>
<td align="right">0.09</td>
<td align="right">0.48</td>
<td align="right">0.45</td>
<td align="right">0.85</td>
<td align="left">Positive</td>
<td align="left">Negative</td>
<td align="left">No Benefit</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">Temperate or sub-polar needleleaf forest</td>
<td align="right">0.74</td>
<td align="right">2.49</td>
<td align="right">2.33</td>
<td align="right">1.46</td>
<td align="left">Negative</td>
<td align="left">Negative</td>
<td align="left">Benefit</td>
<td align="left">0.002</td>
</tr>
<tr class="even">
<td align="left">Barren Lands</td>
<td align="right">0.00</td>
<td align="right">2.19</td>
<td align="right">1.99</td>
<td align="right">3.29</td>
<td align="left">Positive</td>
<td align="left">Negative</td>
<td align="left">No Benefit</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">Water</td>
<td align="right">15.00</td>
<td align="right">7.26</td>
<td align="right">7.96</td>
<td align="right">6.85</td>
<td align="left">Negative</td>
<td align="left">Positive</td>
<td align="left">No Benefit</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">Temperate or sub-polar shrubland</td>
<td align="right">37.31</td>
<td align="right">5.92</td>
<td align="right">8.78</td>
<td align="right">7.08</td>
<td align="left">Positive</td>
<td align="left">Positive</td>
<td align="left">Benefit</td>
<td align="left">0.029</td>
</tr>
<tr class="odd">
<td align="left">Temperate or sub-polar grassland</td>
<td align="right">0.00</td>
<td align="right">8.48</td>
<td align="right">7.71</td>
<td align="right">8.58</td>
<td align="left">Positive</td>
<td align="left">Negative</td>
<td align="left">No Benefit</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">Sub-polar or polar barren-lichen-moss</td>
<td align="right">2.87</td>
<td align="right">11.19</td>
<td align="right">10.43</td>
<td align="right">9.79</td>
<td align="left">Negative</td>
<td align="left">Negative</td>
<td align="left">Benefit</td>
<td align="left">0.008</td>
</tr>
<tr class="odd">
<td align="left">Sub-polar taiga needleleaf forest</td>
<td align="right">8.15</td>
<td align="right">7.14</td>
<td align="right">7.23</td>
<td align="right">10.78</td>
<td align="left">Positive</td>
<td align="left">Positive</td>
<td align="left">Benefit</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left">Wetland</td>
<td align="right">30.19</td>
<td align="right">25.81</td>
<td align="right">26.21</td>
<td align="right">20.36</td>
<td align="left">Negative</td>
<td align="left">Positive</td>
<td align="left">No Benefit</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">Sub-polar or polar grassland-lichen-moss</td>
<td align="right">5.65</td>
<td align="right">28.99</td>
<td align="right">26.87</td>
<td align="right">30.78</td>
<td align="left">Positive</td>
<td align="left">Negative</td>
<td align="left">No Benefit</td>
<td align="left">0</td>
</tr>
</tbody>
</table>
<p>In the table above, there are only 5 land cover types with a benefit
(Urban and Built-up,Temperate or sub-polar needleleaf forest, Wetland,
Sub-polar or polar grasslandlichen-moss, and Sub-polar taiga needleleaf
forest). As mentioned above “Temperate or sub-polar shrubland” moves the
hypothetical sample set away from the study area percentage. However for
“Sub-polar taiga needleleaf” the focal sample unit’s low percentage is a
benefit because it moves the hypothetical sample set percentage lower
and closer to the study area’s percent.</p>
<p>The benefit for the focal sample unit with this hypothetical sample
unit is 0.039. However, as we only sampled 10 sample units for the
hypothetical sample set, we may not have an accurate picture of the
benefit of this focal sample unit.</p>
<hr>
</div>
<div class="section level3">
<h3 id="e--repeat-multiple-times">E. Repeat multiple times<a class="anchor" aria-label="anchor" href="#e--repeat-multiple-times"></a>
</h3>
<p>To get a more useful measure of benefit, we calculate the benefit
from this focal sample unit across 200 randomly drawn hypothetical
sample sets.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>β</mi><mo accent="true">‾</mo></mover><mi>j</mi></msub><mo>=</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>j</mi><mo>=</mo><mi>N</mi></mrow></munderover><msub><mi>β</mi><mrow><mi>H</mi><mi>j</mi></mrow></msub></mrow><mi>N</mi></mfrac></mrow><annotation encoding="application/x-tex">\bar\beta_{j} =  \frac{\sum_{j = 1}^{j = N}\beta_{Hj}}{N} </annotation></semantics></math></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># landcover_ha &lt;- StudyArea_hexes$landcover %&gt;%</span></span>
<span><span class="co">#   mutate_at(.vars = vars(contains("LC")),.funs = ~(.*area)) %&gt;% ungroup</span></span>
<span><span class="co"># att.long &lt;- BASSr::prepare_hab_long(as_tibble(landcover_ha))</span></span>
<span><span class="co"># set.seed(1234)</span></span>
<span><span class="va">sample_hexes200</span> <span class="op">&lt;-</span> <span class="fu">BASSr</span><span class="fu">::</span><span class="fu"><a href="../reference/draw_random_samples.html">draw_random_samples</a></span><span class="op">(</span> <span class="co"># att_cleaned = as_tibble(landcover_ha),</span></span>
<span>  land_hex <span class="op">=</span> <span class="va">StudyArea_hexes</span><span class="op">$</span><span class="va">landcover</span>, use_grts <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  num_runs <span class="op">=</span> <span class="fl">200</span>, n_samples <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span><span class="va">multi_ex</span> <span class="op">&lt;-</span> <span class="fu">BASSr</span><span class="fu">::</span><span class="fu"><a href="../reference/calculate_benefit.html">calculate_benefit</a></span><span class="op">(</span></span>
<span>  samples <span class="op">=</span> <span class="va">sample_hexes200</span>, <span class="co">#|&gt;</span></span>
<span>  <span class="co"># mutate_at(.vars = vars(contains("LC")),.funs = ~(.*hexsize)) ,</span></span>
<span>  hex_id <span class="op">=</span> <span class="va">SampleUnitID</span>,</span>
<span>  land_hex <span class="op">=</span> <span class="va">StudyArea_hexes</span><span class="op">$</span><span class="va">landcover</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># exampleHex%&gt;% #as_tibble %&gt;%</span></span>
<span>  <span class="co"># mutate_at(.vars = vars(contains("LC")),.funs = ~(.*hexsize)) ) |&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SampleUnitID</span> <span class="op">==</span> <span class="va">exampleHex</span><span class="op">$</span><span class="va">SampleUnitID</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">BASSr</span><span class="fu">:::</span><span class="fu">prepare_hab_long</span><span class="op">(</span></span>
<span>  <span class="va">StudyArea_hexes</span><span class="op">$</span><span class="va">landcover</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">area</span><span class="op">)</span></span>
<span>  <span class="co"># mutate_at(.vars = vars(contains("LC")),.funs = ~(.*hexsize))</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"lc"</span>, <span class="st">"area_total"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="st">"area"</span> <span class="op">=</span> <span class="st">"area_total"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">lc</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 13 × 2</span></span></span>
<span><span class="co">#&gt;    lc         area</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> LC01   <span style="text-decoration: underline;">1</span>469.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> LC02  <span style="text-decoration: underline;">10</span>808.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> LC05    856.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> LC06    139.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> LC08   <span style="text-decoration: underline;">7</span>096.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> LC10   <span style="text-decoration: underline;">8</span>603.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> LC11      0.370</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> LC12  <span style="text-decoration: underline;">30</span>873.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> LC13   <span style="text-decoration: underline;">9</span>823.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> LC14  <span style="text-decoration: underline;">20</span>424.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> LC16   <span style="text-decoration: underline;">3</span>298.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> LC17     41.4  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> LC18   <span style="text-decoration: underline;">6</span>871.</span></span>
<span><span class="va">SA_sum</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ha <span class="op">=</span> <span class="va">pHab_SA</span> <span class="op">*</span> <span class="va">study_area_size</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">lc</span>, <span class="va">ha</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">lc</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 13 × 2</span></span></span>
<span><span class="co">#&gt;    lc           ha</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> LC01   <span style="text-decoration: underline;">1</span>469.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> LC02  <span style="text-decoration: underline;">10</span>808.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> LC05    856.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> LC06    139.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> LC08   <span style="text-decoration: underline;">7</span>096.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> LC10   <span style="text-decoration: underline;">8</span>603.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> LC11      0.370</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> LC12  <span style="text-decoration: underline;">30</span>873.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> LC13   <span style="text-decoration: underline;">9</span>823.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> LC14  <span style="text-decoration: underline;">20</span>424.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> LC16   <span style="text-decoration: underline;">3</span>298.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> LC17     41.4  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> LC18   <span style="text-decoration: underline;">6</span>871.</span></span>
<span></span>
<span></span>
<span><span class="va">multi_exbroken</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span></span>
<span>  <span class="fl">1</span><span class="op">:</span><span class="fl">200</span>,</span>
<span>  <span class="op">~</span> <span class="fu">BASSr</span><span class="fu">:::</span><span class="fu">quick_ben</span><span class="op">(</span></span>
<span>    d <span class="op">=</span> <span class="va">exampleHex</span>, <span class="co"># %&gt;% as_tibble %&gt;%</span></span>
<span>    <span class="co"># dplyr::select(-geometry) %&gt;%</span></span>
<span>    <span class="co"># mutate_at(.vars = vars(contains("LC")),</span></span>
<span>    <span class="co"># .funs = ~(.*hexsize)),</span></span>
<span>    samples <span class="op">=</span> <span class="va">sample_hexes200</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">run</span> <span class="op">==</span> <span class="va">.x</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html" class="external-link">summarize_at</a></span><span class="op">(</span>.vars <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"LC"</span><span class="op">)</span><span class="op">)</span>, .funs <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    land_cover_summary <span class="op">=</span> <span class="va">SA_sum</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>area <span class="op">=</span> <span class="va">pHab_SA</span> <span class="op">*</span> <span class="va">study_area_size</span><span class="op">)</span>,</span>
<span>    hex_id <span class="op">=</span> <span class="va">SampleUnitID</span>, print <span class="op">=</span> <span class="cn">F</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">multi_exbroken</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">benefit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">multi_ex</span><span class="op">$</span><span class="va">benefit</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Benefit of Example Sample Unit"</span>, y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># xlim(0, 0.15) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">multi_ex</span><span class="op">$</span><span class="va">benefit</span> <span class="op">+</span> <span class="fl">0.01</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, label <span class="op">=</span> <span class="st">"bar(beta)[j]"</span>, parse <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="BASS_Benefit_Step_by_Step_files/figure-html/unnamed-chunk-14-1.png" alt="Figure 7. Example focal sample unit benefit, calculated using 200 randomly drawn hypothetical sample sets. Mean benefit is shown in the vertical dotted line." width="700"><p class="caption">
Figure 7. Example focal sample unit benefit, calculated using 200
randomly drawn hypothetical sample sets. Mean benefit is shown in the
vertical dotted line.
</p>
</div>
<p>The there is quite a large variation in the benefit calculated across
all sample set iterations. Our final measure of benefit for the focal
sample unit is 0.059. Now, using the same 200 hypothetical sample sets
used to generate Figure 7 for the example focal sample unit we will
calculate the benefit using each of the other sample units in the study
area as the focal sample unit.</p>
<hr>
</div>
<div class="section level3">
<h3 id="f--run-benefit-calculation-for-all-sample-units">F. Run benefit calculation for all sample units<a class="anchor" aria-label="anchor" href="#f--run-benefit-calculation-for-all-sample-units"></a>
</h3>
<p>The total benefit for the example focal sample unit based on national
land cover is shown in Figure 7 (0.059). How does this compare with
values calculated using the other sample units in the study area as the
focal sample unit ? We start by calculating the benefit for each sample
unit using the hypothetical sample set shown in
<code>Figure 5</code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">one_sample</span> <span class="op">&lt;-</span> <span class="fu">BASSr</span><span class="fu">:::</span><span class="fu">quick_ben</span><span class="op">(</span></span>
<span>  d <span class="op">=</span> <span class="va">StudyArea_hexes</span><span class="op">$</span><span class="va">landcover</span>,</span>
<span>  samples <span class="op">=</span> <span class="va">sample_hexes</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  land_cover_summary <span class="op">=</span> <span class="va">SA_sum</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>area <span class="op">=</span> <span class="va">pHab_SA</span> <span class="op">*</span> <span class="va">study_area_size</span><span class="op">)</span>,</span>
<span>  hex_id <span class="op">=</span> <span class="va">SampleUnitID</span>, print <span class="op">=</span> <span class="cn">F</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">one_sample</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">benefit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">multi_ex</span><span class="op">$</span><span class="va">benefit</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Benefit"</span>, y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># xlim(0, 0.15)  +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">multi_ex</span><span class="op">$</span><span class="va">benefit</span> <span class="op">+</span> <span class="fl">0.01</span>, y <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>, label <span class="op">=</span> <span class="st">"bar(beta)[example]"</span>, parse <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="BASS_Benefit_Step_by_Step_files/figure-html/all-benefits-1.png" width="700"></p>
<p>There is as much variation across sample units as there is within
iterations of the example sample units. The example sample unit looks to
be in the middle of a possibly bimodal distribution. However we have
calculated this distribution across all sample units using is just one
hypothetical sample set comprised of only 10 sample units. It is
unlikely to be very informative on its own. As with Figure 7, we will
now use the full 200 randomly drawn hypothetical sample sets.</p>
<p>The goal is to calculate a sample unit’s benefit multiple times with
many randomly drawn hypothetical sample sets. The smaller the number of
sample units in a given hypothetical sample set, the wider the
distribution in benefits are likely to be across all sample units in a
study area and the more variance between runs. So the size of the sample
set should be small and iterations numerous.</p>
<p>I calculated benefit for each sample unit as the focal sample unit
using 200 randomly drawn sample sets of 10 study unit hexagons. A key
point is to start with hectares (or another measure of area) of land
cover in your dataset rather than percent or proportion. Othwerwise, the
benefit calculation will incorrectly estimate habitat representivity for
the focal sample unit plus hypothetical sample set.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set.seed(1234)</span></span>
<span><span class="co"># sample_hexes2 &lt;- BASSr::draw_random_samples(att_cleaned = as_tibble(landcover_ha),</span></span>
<span><span class="co">#                                            att.sf = st_centroid(landcover_ha),</span></span>
<span><span class="co">#                                            num_runs = 200, nsamples = 10)</span></span>
<span></span>
<span><span class="va">benefits2</span> <span class="op">&lt;-</span> <span class="fu">BASSr</span><span class="fu">::</span><span class="fu"><a href="../reference/calculate_benefit.html">calculate_benefit</a></span><span class="op">(</span></span>
<span>  samples <span class="op">=</span> <span class="va">sample_hexes200</span>, <span class="co">#|&gt;</span></span>
<span>  hex_id <span class="op">=</span> <span class="va">SampleUnitID</span>,</span>
<span>  land_hex <span class="op">=</span> <span class="va">StudyArea_hexes</span><span class="op">$</span><span class="va">landcover</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sample_hexes100</span> <span class="op">&lt;-</span> <span class="va">sample_hexes200</span><span class="op">[</span><span class="va">sample_hexes200</span><span class="op">$</span><span class="va">run</span> <span class="op">&lt;=</span> <span class="fl">100</span>, <span class="op">]</span></span>
<span><span class="va">benefits1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_benefit.html">calculate_benefit</a></span><span class="op">(</span></span>
<span>  samples <span class="op">=</span> <span class="va">sample_hexes100</span>, <span class="co">#|&gt;</span></span>
<span>  hex_id <span class="op">=</span> <span class="va">SampleUnitID</span>,</span>
<span>  land_hex <span class="op">=</span> <span class="va">StudyArea_hexes</span><span class="op">$</span><span class="va">landcover</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">benefits2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">benefit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">benefits1</span>, fill <span class="op">=</span> <span class="st">"grey"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span></span>
<span>    xintercept <span class="op">=</span> <span class="va">benefits2</span><span class="op">$</span><span class="va">benefit</span><span class="op">[</span><span class="va">benefits2</span><span class="op">$</span><span class="va">SampleUnitID</span> <span class="op">==</span> <span class="va">exampleHex</span><span class="op">$</span><span class="va">SampleUnitID</span><span class="op">]</span>,</span>
<span>    linetype <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Benefit"</span>, y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.15</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="BASS_Benefit_Step_by_Step_files/figure-html/200iterations-1-1.png" alt="Figure 9. Distribution across all sample units in a study area of the mean benefit calculated using 200 randomly drawn (with replacment; black) hypothetical sample sets or 100 hypothetical sample sets (grey), each consisting of 10 sample units. The mean benefit for the example focal sample unit described above is shown in the dotted line" width="700"><p class="caption">
Figure 9. Distribution across all sample units in a study area of the
mean benefit calculated using 200 randomly drawn (with replacment;
black) hypothetical sample sets or 100 hypothetical sample sets (grey),
each consisting of 10 sample units. The mean benefit for the example
focal sample unit described above is shown in the dotted line
</p>
</div>
<p>Increasing the number of randomly drawn hypothetical sample sets from
100 to 200 does not drastically change the number .</p>
<p>Lets have a look it what a larger sample set size will look like. I
next calculated the mean benefit for all sample units using 200
hypothetical sample sets with 20 samples in each hypothetical sample
set.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">sample_hexes3</span> <span class="op">&lt;-</span> <span class="fu">BASSr</span><span class="fu">::</span><span class="fu"><a href="../reference/draw_random_samples.html">draw_random_samples</a></span><span class="op">(</span></span>
<span>  land_hex <span class="op">=</span> <span class="va">StudyArea_hexes</span><span class="op">$</span><span class="va">landcover</span>, use_grts <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  num_runs <span class="op">=</span> <span class="fl">200</span>, n_samples <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">benefits3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_benefit.html">calculate_benefit</a></span><span class="op">(</span></span>
<span>  samples <span class="op">=</span> <span class="va">sample_hexes3</span>, <span class="co">#|&gt;</span></span>
<span>  hex_id <span class="op">=</span> <span class="va">SampleUnitID</span>,</span>
<span>  land_hex <span class="op">=</span> <span class="va">StudyArea_hexes</span><span class="op">$</span><span class="va">landcover</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">benefits3</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">benefit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">benefits2</span>, fill <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"grey"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span></span>
<span>    xintercept <span class="op">=</span> <span class="va">benefits3</span><span class="op">$</span><span class="va">benefit</span><span class="op">[</span><span class="va">benefits3</span><span class="op">$</span><span class="va">SampleUnitID</span> <span class="op">==</span> <span class="va">exampleHex</span><span class="op">$</span><span class="va">SampleUnitID</span><span class="op">]</span>,</span>
<span>    linetype <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Benefit"</span>, y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.15</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="BASS_Benefit_Step_by_Step_files/figure-html/200iterations-2-1.png" alt="Figure 10. Distribution of mean benefit distribution across all sample units. Calculation of benefit completed using 200 randomly drawn hypothetical sample sets of 20 sample units each (grey distribution).This is compared with the distribution of 200 sample sets of 10 sample units each (black distribution). The mean benefit for the example hexagon with sample sets of 20 sample units is shown in the dotted line." width="700"><p class="caption">
Figure 10. Distribution of mean benefit distribution across all sample
units. Calculation of benefit completed using 200 randomly drawn
hypothetical sample sets of 20 sample units each (grey
distribution).This is compared with the distribution of 200 sample sets
of 10 sample units each (black distribution). The mean benefit for the
example hexagon with sample sets of 20 sample units is shown in the
dotted line.
</p>
</div>
<p>Calculating with hypothetical sample sets of 20 sample units instead
of 10 shifts the benefits for any given sample unit lower. This occurs
as the benefit of adding an individual sample unit to the sample set has
to on average be smaller as the number units comprising of the
hypothetical sample set plus the focal sample unit increases. The shape
of distribution remains roughly the same and the example study unit
hexagon in the same position with both distributions.</p>
</div>
</div>
<div class="section level2">
<h2 id="represent-the-study-area">Represent the Study Area<a class="anchor" aria-label="anchor" href="#represent-the-study-area"></a>
</h2>
<p>After running multiple iterations of drawing hypothetical sample sets
we can then show how the benefit of adding a sample unit to the draw is
expected to increase representivity of the final surveyed sample
units.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">benefit_sf</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">benefits2</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_join.html" class="external-link">st_join</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">StudyArea_hexes</span><span class="op">$</span><span class="va">landcover</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">benefit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">exampleHex</span>, fill <span class="op">=</span> <span class="cn">NA</span>, colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="co">#+</span></span>
<span><span class="co"># ggspatial::annotation_scale(location = "bl", width_hint = 0.4)</span></span>
<span><span class="va">benefit_sf</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="BASS_Benefit_Step_by_Step_files/figure-html/unnamed-chunk-15-1.png" alt="Figure 11. The plotted mean benefit estimate running 200 iterations of hypothetical sample sets each of 10 sample units." width="384"><p class="caption">
Figure 11. The plotted mean benefit estimate running 200 iterations of
hypothetical sample sets each of 10 sample units.
</p>
</div>
</div>
<div class="section level2">
<h2 id="how-the-benefit-calculation-is-used-in-bass">How the benefit calculation is used in BASS<a class="anchor" aria-label="anchor" href="#how-the-benefit-calculation-is-used-in-bass"></a>
</h2>
<p>The benefit for each sample unit calculated here is subsiquently used
with the cost estimate for that sample unit to calculate a selection
probability. If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
is the benefit, rescaled between 0 and 1 with 1 being the highest
benefit in the study area and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math>
is the scaled cost (again between 0 and 1 with 1 being the highest cost
in the study area), then selection probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mi>β</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
p = \beta(1-c)
</annotation></semantics></math></p>
<p>These selection probabilities are then used in selecting the sample
units to sample within that study area using the GRTS algorithm.</p>
<hr>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Hope.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
